---
title: "Music & Mental Health Survey"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
    toc: TRUE
    number_sections: false
    toc_depth: 3
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

![](image_1.png)

<style>
body {
text-align: justify}
</style>


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#Importing all required libraries
library(tidyverse)
library(tibble)
library(dataMaid)
library(ggplot2)
library(plotly)
library(dplyr)
library(DT)
library(knitr)
library(dataMaid)
library(summarytools)
library(janitor)
library(corrplot)
library(reshape2)
library(visdat)
library(papeR)
```

# Team Members
- Charlene 

- Nishadth

- Romain

- Souleym

- Ramaswamy

# Introduction
The dataset explores the relationship between music and mental health. It is based on the concept of Music Therapy, a clinical approach that uses music’s naturally mood-lifting properties to improve a person’s mental health. The dataset is a comprehensive documentation that includes people’s taste in music, their self-declared mental health state at that point of time, and the impact the activity had after. Essentially, the dataset aims to find any correlation between music taste and mental health. 


# Problem Description
The dataset is a culmination of a survey where respondents answered questions on several factors that also include their age, taste in music, their mental health condition, the frequency of the genre they listened to and when, and how they felt after. The participants declared one or more among four mental health conditions – OCD, depression, anxiety, and insomnia – all of which they rated on a scale of 0-10. However, it is important to note that the mental health conditions reported here cannot be confirmed as clinical diagnosis, and rather conditions self-declared by the respondents. Therefore, results obtained from the analysis cannot be taken as scientific evidence and need to be adapted with caution. Nevertheless, the survey and these observations can be used to draw possible and essential parallels between music and mental health, giving more insights on how music therapy can be eventually used to the benefit of those battling mental health conditions.  

For this purpose, we have arrived at a research question to find if there’s a significant correlation between music and mental health. We will examine this through a series of analyses to decipher the links between multiple factors like age, genre of music, streaming platform, and mental health condition at the time of the activity.


# Dataset Description

## Backgroud
The respondents answer generic questions focused on music preferences, their listening habits, and their corresponding mental health status with the severity of their condition ranging from 0-10.


## Music genres
Respondents rank how often they listen to 16 music genres, where they can select:

- Never

- Rarely

- Sometimes

- Very frequently


## Mental health
Respondents rank Anxiety, Depression, Insomnia, and OCD on a scale of 0 to 10, where:

- 0 - I do not experience this.

- 10 - I experience this regularly, constantly/or to an extreme.


# Exploratory Data Analysis(EDA)

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
# Display a glimpse of the MxMH Dataset
mxmh <- read.csv2("./mxmh_survey_results.csv", sep = ",", header = TRUE)
# Cleaning the column names using janitor
mxmh <- clean_names(mxmh, case = "snake")
datatable(mxmh, options = list(pageLength = 5, scrollX = TRUE, scrollY = TRUE, autoWidth = TRUE, css = "table{font-size: 12px;}"))
```

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
# Printing the missing values of all columns in MxMH Dataset
missing_values <- mxmh %>% summarise_all(funs(sum(is.na(.)))) %>% gather()
kable(missing_values)
```

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
# Exploring and Removing all the NAs from the dataset
missing_values <- mxmh %>% summarise_all(funs(sum(is.na(.)))) %>% gather()
kable(missing_values)
```


```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
# Exploring and Removing all the 'EMPTY' value rows from the dataset and printing a sample of clean dataset
kable(colSums(mxmh == ""))
```

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
# Visualizing the missing data
vis_miss(mxmh, cluster = TRUE, sort_miss = TRUE)
```

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
# Removing all the NAs and Empty values and 
mxmh <- mxmh %>% drop_na() 
mxmh <- mxmh %>% filter(rowSums(mxmh == "") == 0)
```


```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
# Printing a sample of clean dataset
datatable(mxmh, options = list(pageLength = 5, scrollX = TRUE, scrollY = TRUE, autoWidth = TRUE, css = "table{font-size: 12px;}"))
```


## Research Questions


### Question_1


#### A. What are different Streaming Services and its total numbers ?

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
# Analysis of Primary streaming service
ggplot(data = mxmh, aes(x = primary_streaming_service)) + 
  geom_bar(aes(fill = primary_streaming_service), stat = "count")+
  ggtitle("Types of Streaming Services") +
  xlab("Streaming Services") +
  ylab("Total no.s")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


#### INFERENCE : As we can see, Spotify seems to be the most preferred streaming service, and by a huge margin, as compared to all the services. Meanwhile, Pandora is the least preferred by the respondents.


#### B. What is the distribution of music played during work ?

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
# Analysis of playing music while working
ggplot(data = mxmh, aes(x = while_working, fill = while_working)) + geom_bar() +
  ggtitle("Hours per day distribution") +
  xlab("Playing music while working") +
  ylab("Hours per day")
```


#### INFERENCE : It can be observed that a majority (over 80%) of respondents prefer to listen to music while work, and a minority that does not.


#### C. What is the distribution of favourite genre of music?

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
ggplot(mxmh, aes(x=factor(1), fill=fav_genre)) +
  geom_bar(width = 1) +
  coord_polar("y") + 
  ggtitle("Favourite Genre distribution") +
  xlab("Various Genre") +
  ylab("Count of Genre")
```


#### INFERENCE : Among the genres of music declared by the respondents, the most preferred seems to be Rock, followed by Pop. Meanwhile, Lofi and Gospel are least listened to genres. 


### Question_2


#### What is the correlation between the age of respondents w.r.t different categories of Streaming Devices ?

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
# Subsetting the relevant columns
mxmh_subset <- mxmh[,c("age","primary_streaming_service")]

# Here since Age is a continuous variable, we are trying to group into x categories based on the WHO
mxmh_subset <- mxmh_subset %>% 
  mutate(Age = case_when(age <= 4  ~ "Infants and young children",
                         age <= 14 ~ "Children and adolescents",
                         age <= 24 ~ "Young people",
                         age <= 59 ~ "Adults",
                         age >= 60 ~ "Senior Adults"))

# Converting all variables to factor
mxmh_subset[,c("age","primary_streaming_service")] <- lapply(mxmh_subset[,c("Age","primary_streaming_service")], as.factor)

# Creating a pivot table
mxmh_pivot <- xtabs( ~ age + primary_streaming_service , data = mxmh_subset)

# Converting pivot table to a cross table
mxmh_crosstable <- addmargins(mxmh_pivot)
mxmh_crosstable <- table(mxmh_subset$age, mxmh_subset$primary_streaming_service)

# Displaying the cross table
kable(mxmh_crosstable, caption = "Cross table for Age and Primary streaming service category", align = "c")

# Convert cross table to dataframe
mxmh_crosstable_df <- as.data.frame(mxmh_crosstable)

# Melting the dataframe
mxmh_crosstable_df_melt <- melt(mxmh_crosstable_df)

# Creating a correlation heatmap - Age vs. Different categories of streaming service
ggplot(mxmh_crosstable_df_melt, aes(x = Var1, y = Var2, fill = value)) +
  geom_tile() +
  scale_fill_gradient(low = "white", high = "red") +
  theme(legend.title = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1), axis.text.y = element_text(angle = 45, hjust = 1))+
  ggtitle("Correlation of Age and Streaming services categories")+ 
  xlab("Age Group")+
  ylab("Primary streaming service categories")

```


#### INFERENCE :  From the above analysis, it can be inferred  that Spotify is the most preferred platform for a large section of young people. Also, most adults, children and adolescents access their music on Spotify as well. YouTube and Apple music seem to come second for young people and adults. However, most children and senior adults are seen to rarely prefer YouTube Music.


### Question_3 


#### What is the distribution of participant's Mental Health conditions ?


```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}

#  Creating a subest and cleaning it
mental_condition <- mxmh[,c("anxiety", "depression", "insomnia", "ocd")]
mental_condition <- as.data.frame(lapply(mental_condition, as.integer))
mental_condition <- round(mental_condition, 0)

# Creating a comparison chart
mental_condition <- pivot_longer(mental_condition, 1:4, names_to= 'Mental_Condition', values_to='Score')
ggplot(data = mental_condition, aes(x = Score, fill = Mental_Condition)) +
  geom_bar(stat = "count") +
  facet_wrap(~Mental_Condition) +
  xlab('Severity Scale')+
  ylab('Number of Participants')+
  theme(strip.text.x = element_text(size = 12), legend.title=element_text(size=12), legend.text=element_text(size=12))+
  ggtitle('Participants Mental Health Distribution')
```


#### INFERENCE :  It is evident from the observation that respondents with anxiety and depression experience higher levels of severity of the condition. Meanwhile, those with insomnia and OCD experience it less intense or less frequently. 



### Question_4


#### How does hours per day listening to music effect mental health?


```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
#  Creating a subest and cleaning it
musiceffect_daily <- mxmh[,c("hours_per_day", "music_effects")]
musiceffect_daily$hours_per_day <- as.numeric(musiceffect_daily$hours_per_day)
musiceffect_daily$music_effects <- as.factor(musiceffect_daily$music_effects)

# Creating a stacked bar chart
ggplot(data = musiceffect_daily, aes(x = hours_per_day, fill = music_effects))+
  geom_bar(position="stack", width = 0.5, size = 2)+
  ylab('Number of Participants')+
  labs(title ='Improvement of mental health vs Hours per day listening to music')+
  scale_x_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30))+
  scale_fill_manual(values = c("Green","Yellow","Red"))+
  theme(text = element_text(size = 13))
```

#### INFERENCE :  There seems to be a link between the hours spent listening to music and its impact on the mental health condition. There is a clear indication that for most respondents, mental health improves after listening to music, and by a huge margin. At the same time, there's a considerable population that did not experience any change in their conditions after music. However, only a small portion says music worsened their mental state and the severity of their condition.

### Question_5 


#### What is the effect of various music genre on different mental health conditions ?


#### Genre effect on Anxiety

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
# Subsetting the relevant columns for Anxiety
anxiety_genre <- subset(mxmh, select = c(fav_genre, anxiety, music_effects))

ggplot(anxiety_genre, aes(x = fav_genre, fill = music_effects)) + 
  geom_bar(position="dodge") + 
  geom_text(aes(label = stat(count), y = stat(count)), stat = "count", position = position_dodge(width = 1)) +
  labs(title = "Different Genre effect on Anxiety") + xlab("Favourite Genre") + 
  theme(axis.text.x= element_text(size =10, angle = 90)) + 
  scale_fill_manual(breaks =c("Improve","No effect","Worsen"),values=c("green", "grey", "red"))
```


### Question_6


#### Is there a relationship between age and how many hours participants listen to music per day?


```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
# Subsetting the relevant columns
mxmh_subset <- mxmh[,c("age","hours_per_day")]
mxmh_subset$hours_per_day <- round(as.numeric(mxmh_subset$hours_per_day))

# Plotting the relationship
ggplot(data=mxmh_subset, aes(x=age, y=hours_per_day))+
  geom_point()+
  ylab('Hours per day')+
  labs(title='Age vs. Hours Listening to Music')+
  scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16))+
  scale_x_continuous(breaks=c(0,10,20,30,40,50,60,70,80))+
  theme(text = element_text(size = 13))

# Conclusion : The majority of individuals who do not listen to music are under 40 years old. The majority of participants who listened to music for more than six hours are under the age of thirty. Although the majority of participants in this survey are under the age of 25, it is ambiguous as a representation of the listening habits of older persons. It would be interesting to see the age distribution trends of the participants.

```


### Question_7


#### How does age compare to the effect of music on mental health?

```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
#  Creating a subest and cleaning it
musiceffect_daily <- mxmh[,c("age", "music_effects")]
musiceffect_daily$hours_per_day <- as.numeric(musiceffect_daily$age)
musiceffect_daily$music_effects <- as.factor(musiceffect_daily$music_effects)

# Creating a stacked bar chart
ggplot(data = musiceffect_daily, aes(x = age, fill = music_effects))+
  geom_bar(position="stack", width = 0.5, size = 2)+
  xlab('Age of Participants')+
  ylab('Number of Participants')+
  labs(title ='Improvement of mental health vs Age')+
  scale_x_continuous(breaks=c(0,10,20,30,40,50,60,70,80))+
  scale_fill_manual(values = c("Green","black","Red"))+
  theme(text = element_text(size = 12))

```


### Question_8


#### Does the hearing of music has some effects on the participants of this mxmh musical effect survey ?


```{r, echo=TRUE, warning=FALSE, message=FALSE, results='asis'}
# Plotting the relation on the music over
ggplot(data=mxmh, aes(x=music_effects))+
  geom_bar(fill='light blue')+
  geom_text(aes(label = ..count..), stat = "count", vjust = 0.5, colour = "blue", size = 8)+
  xlab('Effect of Music')+
  ylab('No. of Participants')+
  labs(title='Effectiveness of the Music of the participants')+
  theme(text = element_text(size = 16))

```

# Conclusion


# References
- Dataset : https://www.kaggle.com/datasets/catherinerasgaitis/mxmh-survey-results>

- Age classification : https://doi.org/10.3390/electronics8091039 

- Package Functions : https://cran.r-project.org/web/views/


